import{d as C,u as T,r as u,l as S,j as D,m as M,p as N,c as g,a,t as f,f as V,b as j,g as B,q as R,s as z,w as A,v as I,x as L,F,k as K,o as m,n as x,y as q,z as E,_ as G}from"./main-CBKKYAlx.js";import{u as H}from"./chat-CPhehE9s.js";const U={class:"flex flex-col h-screen bg-gradient-to-b from-cosmic-dark to-gray-900 relative overflow-hidden"},J={class:"bg-cosmic-dark text-white shadow-lg px-6 py-3 flex items-center justify-between z-10"},O={class:"text-2xl font-display font-extrabold cosmic-glow"},P={class:"text-lg leading-relaxed"},Q={class:"text-xs opacity-75 block mt-1"},W={key:0,class:"flex items-center gap-2 animate-fade-in"},X={class:"bg-gray-100 dark:bg-cosmic-light p-4 flex items-center border-t border-gray-300 dark:border-gray-700 fixed bottom-0 w-full"},Y=C({__name:"Chat",setup(Z){const r=H(),w=T(),h=D(),y=M(),s=u(r.currentChat),i=u(""),p=u(!1),l=u(null);S(async()=>{if(!w.isAuthenticated){h.push("/login");return}const t=y.params.id;try{await r.fetchChat(t),s.value=r.currentChat}catch(e){console.error("Chat fetch error:",e),h.push("/chats")}}),N(()=>{var t;return(t=s.value)==null?void 0:t.messages.length},async()=>{await E(),l.value&&l.value.scrollTo({top:l.value.scrollHeight,behavior:"smooth"})},{deep:!0});async function v(){var n,o,d;if(!i.value.trim())return;const t=i.value.trim();i.value="",p.value=!0,await r.sendMessage(t);let e="";const c=await r.streamChatResponse(t,((n=s.value)==null?void 0:n.messages)||[]);for await(const k of c)e+=k,(o=s.value)!=null&&o.messages.length&&s.value.messages[s.value.messages.length-1].role==="assistant"?s.value.messages[s.value.messages.length-1].content=e:(d=s.value)==null||d.messages.push({role:"assistant",content:e,timestamp:new Date});await r.sendMessage(e),p.value=!1}function b(t){return t instanceof q?t.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):new Date(t).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function _(){h.push("/chats")}return(t,e)=>{var c;return m(),g("div",U,[a("header",J,[a("button",{onClick:_,class:"text-gray-300 hover:text-white transition-all duration-300 cosmic-glow"},e[1]||(e[1]=[a("i",{class:"ri-arrow-left-line text-3xl"},null,-1)])),a("h1",O,f(((c=s.value)==null?void 0:c.title)||"New Conversation"),1)]),a("div",{ref_key:"chatContainer",ref:l,class:"flex-1 overflow-y-auto px-6 py-4 space-y-4 animate-fade-in"},[V(R,{name:"message-pop",tag:"div"},{default:B(()=>{var n;return[(m(!0),g(F,null,K((n=s.value)==null?void 0:n.messages,(o,d)=>(m(),g("div",{key:d,class:x(["flex transition-all duration-300",{"justify-end":o.role==="user","justify-start":o.role==="assistant"}])},[a("div",{class:x(["max-w-[75%] p-4 rounded-lg shadow-md transition-all duration-500 transform hover:scale-[1.02]",o.role==="user"?"bg-cosmic-accent text-white shadow-cosmic-glow":"bg-gray-200 dark:bg-cosmic-light text-gray-900 shadow-md"])},[a("p",P,f(o.content),1),a("span",Q,f(b(o.timestamp)),1)],2)],2))),128))]}),_:1}),p.value?(m(),g("div",W,e[2]||(e[2]=[z('<div class="p-3 bg-gray-200 dark:bg-cosmic-light text-gray-800 rounded-lg shadow-md" data-v-ee2bed00><span class="text-sm flex items-center" data-v-ee2bed00> DawntasyAI is typing <span class="dot one" data-v-ee2bed00></span><span class="dot two" data-v-ee2bed00></span><span class="dot three" data-v-ee2bed00></span></span></div>',1)]))):j("",!0)],512),a("div",X,[A(a("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>i.value=n),onKeydown:L(v,["enter"]),placeholder:"Type a message...",class:"flex-1 px-4 py-2 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-md focus:outline-none transition-all duration-200"},null,544),[[I,i.value]]),a("button",{onClick:v,class:"ml-3 p-3 rounded-full bg-cosmic-accent text-white shadow-md hover:scale-110 transition-all duration-200"},e[3]||(e[3]=[a("i",{class:"ri-send-plane-2-line text-2xl"},null,-1)]))])])}}}),te=G(Y,[["__scopeId","data-v-ee2bed00"]]);export{te as default};
